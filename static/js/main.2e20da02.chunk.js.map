{"version":3,"sources":["swap/utils/pubkeys.ts","swap/context/TokenList.tsx","swap/context/Sollet.tsx","swap/context/Dex.tsx","swap/context/Swap.tsx","swap/utils/tokens.ts","swap/context/Token.tsx","swap/components/TokenDialog.tsx","swap/components/OpenOrdersDialog.tsx","swap/components/Settings.tsx","swap/components/Info.tsx","swap/components/Swap.tsx","swap/index.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["DEX_PID","PublicKey","SRM_MINT","USDC_MINT","USDT_MINT","WORM_MARKET_BASE","WORM_USDC_MINT","WORM_USDC_MARKET","WORM_USDT_MINT","WORM_USDT_MARKET","_TokenListContext","React","createContext","SPL_REGISTRY_SOLLET_TAG","SPL_REGISTRY_WORM_TAG","TokenListContextProvider","props","tokenList","useMemo","filterByClusterSlug","getList","tokenMap","Map","forEach","t","set","address","swappableTokens","tokens","filter","isUsdxQuoted","extensions","serumV3Usdt","serumV3Usdc","isSol","concat","get","toString","sort","a","b","symbol","tags","includes","map","swappableTokensSollet","solletMap","swappableTokensWormhole","wormholeMap","Provider","value","children","useTokenListContext","ctx","useContext","Error","useTokenMap","fetchSolletInfo","mint","undefined","info","_SOLLET_INFO_CACHE","swapApiRequest","infoRaw","splMint","requestWormholeSwapMarketIfNeeded","connection","solletMint","wormholeMint","swapMarket","solletInfo","cached","_SWAP_MARKET_EXISTS_CACHE","getAccountInfo","ticker","catch","console","error","method","path","body","params","headers","cache","JSON","stringify","fetch","resp","handleSwapApiResponse","json","success","SwapApiError","status","result","msg","name","_DexContext","DexContextProvider","useState","ooAccounts","setOoAccounts","swapClient","useEffect","program","provider","wallet","publicKey","OpenOrders","findForOwner","then","openOrders","newOoAccounts","markets","Set","oo","add","market","push","size","anchor","getMultipleAccounts","m","programAccount","account","Promise","resolve","Market","getLayout","decode","data","opts","_MARKET_CACHE","useDexContext","useOpenOrders","useMarket","asyncMarket","useAsync","marketClient","load","useBbo","orderbook","refresh","setRefresh","asyncOrderbook","_ORDERBOOK_CACHE","all","loadBids","loadAsks","bids","asks","listener","bidsAddress","onAccountChange","OrderbookSide","oldBestBid","items","next","newBestBid","price","r","removeAccountChangeListener","asksAddress","oldBestOffer","newBestOffer","useOrderbook","bestBid","bestOffer","mid","useRoute","fromMint","toMint","route","useRouteVerbose","asyncRoute","wormholeSwapMarket","wormholeMarket","kind","WORMHOLE_NATIVE_MAP","wormKey","first","second","conn","wormholeNativeMarket","wormholeSolletMarket","fromWormhole","isFromWormhole","toWormhole","isToWormhole","fromSollet","isFromSollet","toSollet","isToSollet","base","quote","wormholeInfo","erc20Contract","deriveWormholeMarket","baseMint","quoteMint","version","log","padToTwo","n","slice","seed","createWithSeed","_SwapContext","SwapContextProvider","setFromMint","setToMint","fromAmount","_setFromAmount","toAmount","_setToAmount","isClosingNewAccounts","setIsClosingNewAccounts","slippage","setSlippage","fairOverride","setFairOverride","fair","_useSwapFair","referral","assert","setFromAmount","amount","setToAmount","swapToFromMints","oldFrom","oldFromAmount","oldToAmount","useSwapContext","useSwapFair","fairRoute","fromBbo","fromMarket","toBbo","length","baseMintAddress","equals","useFairRoute","filters","getOwnedAccountsFilters","_rpcRequest","TOKEN_PROGRAM_ID","toBase58","commitment","message","pubkey","executable","owner","lamports","accountInfo","bs58","every","dataSize","memcmp","filterBytes","bytes","offset","parseTokenAccountData","ACCOUNT_LAYOUT","BufferLayout","BN","offsetOf","span","_TokenContext","TokenContextProvider","_OWNED_TOKEN_ACCOUNTS_CACHE","getOwnedTokenAccounts","accs","useTokenContext","useOwnedTokenAccount","tokenAccounts","tokenAccount","token","index","indexOf","useMint","asyncMintInfo","_MINT_CACHE","mintClient","Token","Account","mintInfo","getMintInfo","useStyles","makeStyles","dialogContent","paddingTop","paddingBottom","textField","width","border","borderRadius","marginBottom","tab","minWidth","TokenDialog","open","onClose","setMint","tabSelection","setTabSelection","tokenFilter","setTokenFilter","toLowerCase","styles","useSwappableTokens","selectedTokens","startsWith","Dialog","scroll","PaperProps","style","DialogTitle","fontWeight","Typography","variant","TextField","className","placeholder","onChange","e","target","InputProps","disableUnderline","padding","DialogContent","dividers","List","disablePadding","tokenInfo","TokenListItem","onClick","DialogActions","Tabs","v","Tab","label","ListItem","button","TokenIcon","TokenName","marginLeft","color","fontSize","theme","table","closeAccountSwitchLabel","palette","text","secondary","OpenOrdersDialog","maxWidth","height","display","justifyContent","IconButton","position","right","top","Close","OpenOrdersAccounts","openOrdersEntries","Array","from","entries","TableContainer","component","Paper","elevation","Table","aria-label","TableHead","TableRow","TableCell","align","TableBody","oos","OpenOrdersRow","ooAccount","setOoAccount","quoteMintAddress","baseWallet","quoteWallet","baseTicker","quoteTicker","marketName","settleDisabled","baseTokenFree","toNumber","quoteTokenFree","closeDisabled","baseTokenTotal","quoteTokenTotal","settleFunds","makeSettleFundsTransaction","transaction","signers","send","closeOpenOrders","scope","Link","href","rel","Select","MenuItem","toDisplay","sub","Button","disabled","decimals","toFixed","settingsButton","SettingsButton","popupState","bindTrigger","Popover","bindPopover","anchorOrigin","vertical","horizontal","transformOrigin","SettingsDetails","showSettingsDialog","setShowSettingsDialog","marginTop","type","parseFloat","flexDirection","endAdornment","InputAdornment","marginRight","flex","ToggleButton","selected","paddingLeft","paddingRight","CloseNewAccountsSwitch","background","FormGroup","row","FormControlLabel","classes","labelPlacement","control","Switch","checked","infoLabel","fairPriceLabel","infoButton","InfoLabel","fromMintInfo","fromTokenInfo","toTokenInfo","InfoButton","Info","disableRestoreFocus","InfoDetails","addresses","MarketRoute","overflow","useMarketName","bbo","card","cardContent","swapButton","swapToFromButton","SwapCard","Card","SwapHeader","SwapFromForm","ArrowButton","SwapToForm","SwapButton","margin","SwapTokenForm","setAmount","showTokenDialog","setShowTokenDialog","mintAccount","TokenButton","ExpandMore","logoURI","alt","src","toMintInfo","toMarket","canSwap","useCanSwap","asyncReferral","getAssociatedTokenAddress","ASSOCIATED_TOKEN_PROGRAM_ID","useReferral","sendSwapTransaction","mul","pow","minExchangeRate","rate","divn","muln","fromOpenOrders","toOpenOrders","swap","close","Swap","SwapClient","AppInner","enqueueSnackbar","useSnackbar","isConnected","setIsConnected","setTokenList","preflightCommitment","network","Wallet","Connection","NotifyingProvider","tx","err","action","TokenListProvider","on","left","bottom","disconnect","connect","onTransaction","txSig","this","txs","txSigs","sig","App","maxSnack","autoHideDuration","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2e20da02.chunk.js","sourcesContent":["import { PublicKey } from \"@solana/web3.js\";\n\nexport const DEX_PID = new PublicKey(\n  \"9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin\"\n);\n\nexport const SRM_MINT = new PublicKey(\n  \"SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt\"\n);\n\nexport const USDC_MINT = new PublicKey(\n  \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\"\n);\n\nexport const USDT_MINT = new PublicKey(\n  \"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB\"\n);\n\nexport const WORM_MARKET_BASE = new PublicKey(\n  \"6a9wpsZpZGxGhFVSQBpcTNjNjytdbSA1iUw1A5KNDxPw\"\n);\n\nexport const WORM_USDC_MINT = new PublicKey(\n  \"FVsXUnbhifqJ4LiXQEbpUtXVdB8T5ADLKqSs5t1oc54F\"\n);\n\nexport const WORM_USDC_MARKET = new PublicKey(\n  \"6nGMps9VfDjkKEwYjdSNqN1ToXkLae4VsN49fzBiDFBd\"\n);\n\nexport const WORM_USDT_MINT = new PublicKey(\n  \"9w97GdWUYYaamGwdKMKZgGzPduZJkiFizq4rz5CPXRv2\"\n);\n\nexport const WORM_USDT_MARKET = new PublicKey(\n  \"4v6e6vNXAaEunrvbqkYnKwbaWfck8a2KVR4uRAVXxVwC\"\n);\n","import React, { useContext, useMemo } from \"react\";\nimport { TokenInfo } from \"@solana/spl-token-registry\";\nimport { USDC_MINT, USDT_MINT } from \"../utils/pubkeys\";\n\ntype TokenListContext = {\n  tokenMap: Map<string, TokenInfo>;\n  wormholeMap: Map<string, TokenInfo>;\n  solletMap: Map<string, TokenInfo>;\n  swappableTokens: TokenInfo[];\n  swappableTokensSollet: TokenInfo[];\n  swappableTokensWormhole: TokenInfo[];\n};\nconst _TokenListContext = React.createContext<null | TokenListContext>(null);\n\n// Tag in the spl-token-registry for sollet wrapped tokens.\nexport const SPL_REGISTRY_SOLLET_TAG = \"wrapped-sollet\";\n\n// Tag in the spl-token-registry for wormhole wrapped tokens.\nexport const SPL_REGISTRY_WORM_TAG = \"wormhole\";\n\nexport function TokenListContextProvider(props: any) {\n  const tokenList = useMemo(\n    () => props.tokenList.filterByClusterSlug(\"mainnet-beta\").getList(),\n    [props.tokenList]\n  );\n\n  // Token map for quick lookup.\n  const tokenMap = useMemo(() => {\n    const tokenMap = new Map();\n    tokenList.forEach((t: TokenInfo) => {\n      tokenMap.set(t.address, t);\n    });\n    return tokenMap;\n  }, [tokenList]);\n\n  // Tokens with USD(x) quoted markets.\n  const swappableTokens = useMemo(() => {\n    const tokens = tokenList\n      .filter((t: TokenInfo) => {\n        const isUsdxQuoted =\n          t.extensions?.serumV3Usdt || t.extensions?.serumV3Usdc;\n        const isSol =\n          t.address === \"So11111111111111111111111111111111111111112\";\n        return isUsdxQuoted && !isSol;\n      })\n      .concat([\n        tokenMap.get(USDC_MINT.toString()),\n        tokenMap.get(USDT_MINT.toString()),\n      ]);\n    tokens.sort((a: TokenInfo, b: TokenInfo) =>\n      a.symbol < b.symbol ? -1 : a.symbol > b.symbol ? 1 : 0\n    );\n    return tokens;\n  }, [tokenList, tokenMap]);\n\n  // Sollet wrapped tokens.\n  const [swappableTokensSollet, solletMap] = useMemo(() => {\n    const tokens = tokenList.filter((t: TokenInfo) => {\n      const isSollet = t.tags?.includes(SPL_REGISTRY_SOLLET_TAG);\n      return isSollet;\n    });\n    tokens.sort((a: TokenInfo, b: TokenInfo) =>\n      a.symbol < b.symbol ? -1 : a.symbol > b.symbol ? 1 : 0\n    );\n    return [\n      tokens,\n      new Map<string, TokenInfo>(tokens.map((t: TokenInfo) => [t.address, t])),\n    ];\n  }, [tokenList]);\n\n  // Wormhole wrapped tokens.\n  const [swappableTokensWormhole, wormholeMap] = useMemo(() => {\n    const tokens = tokenList.filter((t: TokenInfo) => {\n      const isSollet = t.tags?.includes(SPL_REGISTRY_WORM_TAG);\n      return isSollet;\n    });\n    tokens.sort((a: TokenInfo, b: TokenInfo) =>\n      a.symbol < b.symbol ? -1 : a.symbol > b.symbol ? 1 : 0\n    );\n    return [\n      tokens,\n      new Map<string, TokenInfo>(tokens.map((t: TokenInfo) => [t.address, t])),\n    ];\n  }, [tokenList]);\n\n  return (\n    <_TokenListContext.Provider\n      value={{\n        tokenMap,\n        wormholeMap,\n        solletMap,\n        swappableTokens,\n        swappableTokensWormhole,\n        swappableTokensSollet,\n      }}\n    >\n      {props.children}\n    </_TokenListContext.Provider>\n  );\n}\n\nexport function useTokenListContext(): TokenListContext {\n  const ctx = useContext(_TokenListContext);\n  if (ctx === null) {\n    throw new Error(\"Context not available\");\n  }\n  return ctx;\n}\n\nexport function useTokenMap(): Map<string, TokenInfo> {\n  const { tokenMap } = useTokenListContext();\n  return tokenMap;\n}\n\nexport function useSwappableTokens() {\n  const { swappableTokens, swappableTokensWormhole, swappableTokensSollet } =\n    useTokenListContext();\n  return { swappableTokens, swappableTokensWormhole, swappableTokensSollet };\n}\n","import { useAsync, UseAsyncReturn } from \"react-async-hook\";\nimport { Connection, PublicKey } from \"@solana/web3.js\";\n\n// Token info tracked by the sollet bridge.\ntype SolletInfo = {\n  blockchain: string;\n  erc20Contract: string;\n  name: string;\n  splMint: PublicKey;\n  ticker: string;\n};\n\nexport function useSolletInfo(mint: PublicKey): UseAsyncReturn<SolletInfo> {\n  return useAsync(async () => {\n    return fetchSolletInfo(mint);\n  }, [mint]);\n}\n\n// Fetches the token info from the sollet bridge.\nexport async function fetchSolletInfo(mint: PublicKey): Promise<SolletInfo> {\n  let info = _SOLLET_INFO_CACHE.get(mint.toString());\n  if (info !== undefined) {\n    return info;\n  }\n\n  const infoRaw = await swapApiRequest(\"GET\", `coins/sol/${mint.toString()}`);\n  info = { ...infoRaw, splMint: new PublicKey(infoRaw.splMint) };\n  _SOLLET_INFO_CACHE.set(mint.toString(), info!);\n\n  return info!;\n}\n\n// Requests the creation of a sollet wormhole swap market, if it doesn't\n// already exist. Note: this triggers a creation notification. Creation\n// doesn't happen immediately, but at some unspecified point in the future\n// since market makers need to setup on the swap market and provide liquidity.\n//\n// Returns true if the market exists already. False otherwise.\nexport async function requestWormholeSwapMarketIfNeeded(\n  connection: Connection,\n  solletMint: PublicKey,\n  wormholeMint: PublicKey,\n  swapMarket: PublicKey,\n  solletInfo: SolletInfo\n): Promise<boolean> {\n  const cached = _SWAP_MARKET_EXISTS_CACHE.get(swapMarket.toString());\n  if (cached !== undefined) {\n    return cached;\n  }\n  const acc = await connection.getAccountInfo(swapMarket);\n  if (acc === null) {\n    _SWAP_MARKET_EXISTS_CACHE.set(swapMarket.toString(), false);\n    const resource = `wormhole/pool/${\n      solletInfo.ticker\n    }/${swapMarket.toString()}/${solletMint.toString()}/${wormholeMint.toString()}`;\n    swapApiRequest(\"POST\", resource).catch(console.error);\n    return false;\n  } else {\n    _SWAP_MARKET_EXISTS_CACHE.set(swapMarket.toString(), true);\n    return true;\n  }\n}\n\nexport async function swapApiRequest(\n  method: string,\n  path: string,\n  body?: Object\n) {\n  let headers: any = {};\n  let params: any = { headers, method };\n  if (method === \"GET\") {\n    params.cache = \"no-cache\";\n  } else if (body) {\n    headers[\"Content-Type\"] = \"application/json\";\n    params.body = JSON.stringify(body);\n  }\n  let resp = await fetch(`https://swap.sollet.io/api/${path}`, params);\n  return await handleSwapApiResponse(resp);\n}\n\nasync function handleSwapApiResponse(resp: Response) {\n  let json = await resp.json();\n  if (!json.success) {\n    throw new SwapApiError(json.error, resp.status);\n  }\n  return json.result;\n}\n\nexport class SwapApiError extends Error {\n  readonly name: string;\n  readonly status: number;\n  constructor(msg: string, status: number) {\n    super(msg);\n    this.name = \"SwapApiError\";\n    this.status = status;\n  }\n}\n\nconst _SOLLET_INFO_CACHE = new Map<string, SolletInfo>();\nconst _SWAP_MARKET_EXISTS_CACHE = new Map<string, boolean>();\n","import React, { useContext, useState, useEffect } from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport { TokenInfo } from \"@solana/spl-token-registry\";\nimport { Connection, PublicKey } from \"@solana/web3.js\";\nimport * as anchor from \"@project-serum/anchor\";\nimport { Swap as SwapClient } from \"@project-serum/swap\";\nimport {\n  Market,\n  OpenOrders,\n  Orderbook as OrderbookSide,\n} from \"@project-serum/serum\";\nimport {\n  DEX_PID,\n  USDC_MINT,\n  USDT_MINT,\n  WORM_USDC_MINT,\n  WORM_USDT_MINT,\n  WORM_USDC_MARKET,\n  WORM_USDT_MARKET,\n  WORM_MARKET_BASE,\n} from \"../utils/pubkeys\";\nimport { useTokenMap, useTokenListContext } from \"./TokenList\";\nimport { fetchSolletInfo, requestWormholeSwapMarketIfNeeded } from \"./Sollet\";\n\nexport const BASE_TAKER_FEE_BPS = 0.0022;\n\ntype DexContext = {\n  // Maps market address to open orders accounts.\n  openOrders: Map<string, Array<OpenOrders>>;\n  swapClient: SwapClient;\n};\nconst _DexContext = React.createContext<DexContext | null>(null);\n\nexport function DexContextProvider(props: any) {\n  const [ooAccounts, setOoAccounts] = useState<Map<string, Array<OpenOrders>>>(\n    new Map()\n  );\n  const swapClient = props.swapClient;\n\n  // Two operations:\n  //\n  // 1. Fetch all open orders accounts for the connected wallet.\n  // 2. Batch fetch all market accounts for those open orders.\n  //\n  useEffect(() => {\n    if (!swapClient.program.provider.wallet.publicKey) {\n      setOoAccounts(new Map());\n      return;\n    }\n    OpenOrders.findForOwner(\n      swapClient.program.provider.connection,\n      swapClient.program.provider.wallet.publicKey,\n      DEX_PID\n    ).then(async (openOrders) => {\n      const newOoAccounts = new Map();\n      let markets = new Set<string>();\n      openOrders.forEach((oo) => {\n        markets.add(oo.market.toString());\n        if (newOoAccounts.get(oo.market.toString())) {\n          newOoAccounts.get(oo.market.toString()).push(oo);\n        } else {\n          newOoAccounts.set(oo.market.toString(), [oo]);\n        }\n      });\n      if (markets.size > 100) {\n        // Punt request chunking until there's user demand.\n        throw new Error(\n          \"Too many markets. Please file an issue to update this\"\n        );\n      }\n      (\n        await anchor.utils.getMultipleAccounts(\n          swapClient.program.provider.connection,\n          // @ts-ignore\n          [...markets].map((m) => new PublicKey(m))\n        )\n      )\n        .map((programAccount) => {\n          return {\n            publicKey: programAccount?.publicKey,\n            account: new Promise<Market>((resolve) =>\n              resolve(\n                new Market(\n                  Market.getLayout(DEX_PID).decode(\n                    programAccount?.account.data\n                  ),\n                  -1, // Not used so don't bother fetching.\n                  -1, // Not used so don't bother fetching.\n                  swapClient.program.provider.opts,\n                  DEX_PID\n                )\n              )\n            ),\n          };\n        })\n        .forEach((m) => {\n          _MARKET_CACHE.set(m.publicKey!.toString(), m.account);\n        });\n\n      setOoAccounts(newOoAccounts);\n    });\n  }, [\n    swapClient.program.provider.connection,\n    swapClient.program.provider.wallet.publicKey,\n    swapClient.program.provider.opts,\n  ]);\n  return (\n    <_DexContext.Provider\n      value={{\n        openOrders: ooAccounts,\n        swapClient,\n      }}\n    >\n      {props.children}\n    </_DexContext.Provider>\n  );\n}\n\nexport function useDexContext(): DexContext {\n  const ctx = useContext(_DexContext);\n  if (ctx === null) {\n    throw new Error(\"Context not available\");\n  }\n  return ctx;\n}\n\nexport function useOpenOrders(): Map<string, Array<OpenOrders>> {\n  const ctx = useDexContext();\n  return ctx.openOrders;\n}\n\n// Lazy load a given market.\nexport function useMarket(market?: PublicKey): Market | undefined {\n  const { swapClient } = useDexContext();\n\n  const asyncMarket = useAsync(async () => {\n    if (!market) {\n      return undefined;\n    }\n    if (_MARKET_CACHE.get(market.toString())) {\n      return _MARKET_CACHE.get(market.toString());\n    }\n    const marketClient = Market.load(\n      swapClient.program.provider.connection,\n      market,\n      undefined,\n      DEX_PID\n    );\n\n    _MARKET_CACHE.set(market.toString(), marketClient);\n    return marketClient;\n  }, [swapClient.program.provider.connection, market]);\n\n  if (asyncMarket.result) {\n    return asyncMarket.result;\n  }\n\n  return undefined;\n}\n\n// Lazy load the orderbook for a given market.\nexport function useOrderbook(market?: PublicKey): Orderbook | undefined {\n  const { swapClient } = useDexContext();\n  const marketClient = useMarket(market);\n  const [refresh, setRefresh] = useState(0);\n\n  const asyncOrderbook = useAsync(async () => {\n    if (!market || !marketClient) {\n      return undefined;\n    }\n    if (_ORDERBOOK_CACHE.get(market.toString())) {\n      return _ORDERBOOK_CACHE.get(market.toString());\n    }\n\n    const orderbook = new Promise<Orderbook>(async (resolve) => {\n      const [bids, asks] = await Promise.all([\n        marketClient.loadBids(swapClient.program.provider.connection),\n        marketClient.loadAsks(swapClient.program.provider.connection),\n      ]);\n\n      resolve({\n        bids,\n        asks,\n      });\n    });\n\n    _ORDERBOOK_CACHE.set(market.toString(), orderbook);\n\n    return orderbook;\n  }, [refresh, swapClient.program.provider.connection, market, marketClient]);\n\n  // Stream in bids updates.\n  useEffect(() => {\n    let listener: number | undefined;\n    if (marketClient?.bidsAddress) {\n      listener = swapClient.program.provider.connection.onAccountChange(\n        marketClient?.bidsAddress,\n        async (info) => {\n          const bids = OrderbookSide.decode(marketClient, info.data);\n          const orderbook = await _ORDERBOOK_CACHE.get(\n            marketClient.address.toString()\n          );\n          const oldBestBid = orderbook?.bids.items(true).next().value;\n          const newBestBid = bids.items(true).next().value;\n          if (\n            orderbook &&\n            oldBestBid &&\n            newBestBid &&\n            oldBestBid.price !== newBestBid.price\n          ) {\n            orderbook.bids = bids;\n            setRefresh((r) => r + 1);\n          }\n        }\n      );\n    }\n    return () => {\n      if (listener) {\n        swapClient.program.provider.connection.removeAccountChangeListener(\n          listener\n        );\n      }\n    };\n  }, [\n    marketClient,\n    marketClient?.bidsAddress,\n    swapClient.program.provider.connection,\n  ]);\n\n  // Stream in asks updates.\n  useEffect(() => {\n    let listener: number | undefined;\n    if (marketClient?.asksAddress) {\n      listener = swapClient.program.provider.connection.onAccountChange(\n        marketClient?.asksAddress,\n        async (info) => {\n          const asks = OrderbookSide.decode(marketClient, info.data);\n          const orderbook = await _ORDERBOOK_CACHE.get(\n            marketClient.address.toString()\n          );\n          const oldBestOffer = orderbook?.asks.items(false).next().value;\n          const newBestOffer = asks.items(false).next().value;\n          if (\n            orderbook &&\n            oldBestOffer &&\n            newBestOffer &&\n            oldBestOffer.price !== newBestOffer.price\n          ) {\n            orderbook.asks = asks;\n            setRefresh((r) => r + 1);\n          }\n        }\n      );\n    }\n    return () => {\n      if (listener) {\n        swapClient.program.provider.connection.removeAccountChangeListener(\n          listener\n        );\n      }\n    };\n  }, [\n    marketClient,\n    marketClient?.bidsAddress,\n    swapClient.program.provider.connection,\n  ]);\n\n  if (asyncOrderbook.result) {\n    return asyncOrderbook.result;\n  }\n\n  return undefined;\n}\n\nexport function useMarketName(market: PublicKey): string | null {\n  const tokenMap = useTokenMap();\n  const marketClient = useMarket(market);\n  if (!marketClient) {\n    return null;\n  }\n  const baseTicker = marketClient\n    ? tokenMap.get(marketClient?.baseMintAddress.toString())?.symbol\n    : \"-\";\n  const quoteTicker = marketClient\n    ? tokenMap.get(marketClient?.quoteMintAddress.toString())?.symbol\n    : \"-\";\n  const name = `${baseTicker} / ${quoteTicker}`;\n  return name;\n}\n\n// Fair price for a given market, as defined by the mid.\nexport function useBbo(market?: PublicKey): Bbo | undefined {\n  const orderbook = useOrderbook(market);\n  if (orderbook === undefined) {\n    return undefined;\n  }\n  const bestBid = orderbook.bids.items(true).next().value;\n  const bestOffer = orderbook.asks.items(false).next().value;\n  if (!bestBid) {\n    return { bestOffer: bestOffer.price };\n  }\n  if (!bestOffer) {\n    return { bestBid: bestBid.price };\n  }\n  const mid = (bestBid.price + bestOffer.price) / 2.0;\n  return { bestBid: bestBid.price, bestOffer: bestOffer.price, mid };\n}\n\n// Fair price for a theoretical toMint/fromMint market. I.e., the number\n// of `fromMint` tokens to purchase a single `toMint` token. Aggregates\n// across a trade route, if needed.\nexport function useFairRoute(\n  fromMint: PublicKey,\n  toMint: PublicKey\n): number | undefined {\n  const route = useRoute(fromMint, toMint);\n  const fromBbo = useBbo(route ? route[0] : undefined);\n  const fromMarket = useMarket(route ? route[0] : undefined);\n  const toBbo = useBbo(route ? route[1] : undefined);\n\n  if (route === null) {\n    return undefined;\n  }\n\n  if (route.length === 1 && fromBbo !== undefined) {\n    if (fromMarket === undefined) {\n      return undefined;\n    }\n    if (fromMarket?.baseMintAddress.equals(fromMint)) {\n      return fromBbo.bestBid && 1.0 / fromBbo.bestBid;\n    } else {\n      return fromBbo.bestOffer && fromBbo.bestOffer;\n    }\n  }\n  if (\n    fromBbo === undefined ||\n    fromBbo.bestBid === undefined ||\n    toBbo === undefined ||\n    toBbo.bestOffer === undefined\n  ) {\n    return undefined;\n  }\n  return toBbo.bestOffer / fromBbo.bestBid;\n}\n\nexport function useRoute(\n  fromMint: PublicKey,\n  toMint: PublicKey\n): Array<PublicKey> | null {\n  const route = useRouteVerbose(fromMint, toMint);\n  if (route === null) {\n    return null;\n  }\n  return route.markets;\n}\n\n// Types of routes.\n//\n// 1. Direct trades on USDC quoted markets.\n// 2. Transitive trades across two USDC qutoed markets.\n// 3. Wormhole <-> Sollet one-to-one swap markets.\n// 4. Wormhole <-> Native one-to-one swap markets.\n//\nexport function useRouteVerbose(\n  fromMint: PublicKey,\n  toMint: PublicKey\n): { markets: Array<PublicKey>; kind: RouteKind } | null {\n  const { swapClient } = useDexContext();\n  const { wormholeMap, solletMap } = useTokenListContext();\n  const asyncRoute = useAsync(async () => {\n    const swapMarket = await wormholeSwapMarket(\n      swapClient.program.provider.connection,\n      fromMint,\n      toMint,\n      wormholeMap,\n      solletMap\n    );\n    if (swapMarket !== null) {\n      const [wormholeMarket, kind] = swapMarket;\n      return { markets: [wormholeMarket], kind };\n    }\n    const markets = swapClient.route(fromMint, toMint);\n    if (markets === null) {\n      return null;\n    }\n    const kind: RouteKind = \"usdx\";\n    return { markets, kind };\n  }, [fromMint, toMint, swapClient]);\n\n  if (asyncRoute.result) {\n    return asyncRoute.result;\n  }\n  return null;\n}\n\ntype Orderbook = {\n  bids: OrderbookSide;\n  asks: OrderbookSide;\n};\n\n// Wormhole utils.\n\ntype RouteKind = \"wormhole-native\" | \"wormhole-sollet\" | \"usdx\";\n\n// Maps fromMint || toMint (in sort order) to swap market public key.\n// All markets for wormhole<->native tokens should be here, e.g.\n// USDC <-> wUSDC.\nconst WORMHOLE_NATIVE_MAP = new Map<string, PublicKey>([\n  [wormKey(WORM_USDC_MINT, USDC_MINT), WORM_USDC_MARKET],\n  [wormKey(WORM_USDT_MINT, USDT_MINT), WORM_USDT_MARKET],\n]);\n\nfunction wormKey(fromMint: PublicKey, toMint: PublicKey): string {\n  const [first, second] =\n    fromMint < toMint ? [fromMint, toMint] : [toMint, fromMint];\n  return first.toString() + second.toString();\n}\n\nasync function wormholeSwapMarket(\n  conn: Connection,\n  fromMint: PublicKey,\n  toMint: PublicKey,\n  wormholeMap: Map<string, TokenInfo>,\n  solletMap: Map<string, TokenInfo>\n): Promise<[PublicKey, RouteKind] | null> {\n  let market = wormholeNativeMarket(fromMint, toMint);\n  if (market !== null) {\n    return [market, \"wormhole-native\"];\n  }\n  market = await wormholeSolletMarket(\n    conn,\n    fromMint,\n    toMint,\n    wormholeMap,\n    solletMap\n  );\n  if (market === null) {\n    return null;\n  }\n  return [market, \"wormhole-sollet\"];\n}\n\nfunction wormholeNativeMarket(\n  fromMint: PublicKey,\n  toMint: PublicKey\n): PublicKey | null {\n  return WORMHOLE_NATIVE_MAP.get(wormKey(fromMint, toMint)) ?? null;\n}\n\n// Returns the market address of the 1-1 sollet<->wormhole swap market if it\n// exists. Otherwise, returns null.\nasync function wormholeSolletMarket(\n  conn: Connection,\n  fromMint: PublicKey,\n  toMint: PublicKey,\n  wormholeMap: Map<string, TokenInfo>,\n  solletMap: Map<string, TokenInfo>\n): Promise<PublicKey | null> {\n  const fromWormhole = wormholeMap.get(fromMint.toString());\n  const isFromWormhole = fromWormhole !== undefined;\n\n  const toWormhole = wormholeMap.get(toMint.toString());\n  const isToWormhole = toWormhole !== undefined;\n\n  const fromSollet = solletMap.get(fromMint.toString());\n  const isFromSollet = fromSollet !== undefined;\n\n  const toSollet = solletMap.get(toMint.toString());\n  const isToSollet = toSollet !== undefined;\n\n  if ((isFromWormhole || isToWormhole) && isFromWormhole !== isToWormhole) {\n    if ((isFromSollet || isToSollet) && isFromSollet !== isToSollet) {\n      const base = isFromSollet ? fromMint : toMint;\n      const [quote, wormholeInfo] = isFromWormhole\n        ? [fromMint, fromWormhole]\n        : [toMint, toWormhole];\n\n      const solletInfo = await fetchSolletInfo(base);\n\n      if (solletInfo.erc20Contract !== wormholeInfo!.extensions?.address) {\n        return null;\n      }\n\n      const market = await deriveWormholeMarket(base, quote);\n      if (market === null) {\n        return null;\n      }\n\n      const marketExists = await requestWormholeSwapMarketIfNeeded(\n        conn,\n        base,\n        quote,\n        market,\n        solletInfo\n      );\n      if (!marketExists) {\n        return null;\n      }\n\n      return market;\n    }\n  }\n  return null;\n}\n\n// Calculates the deterministic address for the sollet<->wormhole 1-1 swap\n// market.\nasync function deriveWormholeMarket(\n  baseMint: PublicKey,\n  quoteMint: PublicKey,\n  version = 0\n): Promise<PublicKey | null> {\n  if (version > 99) {\n    console.log(\"Swap market version cannot be greater than 99\");\n    return null;\n  }\n  if (version < 0) {\n    console.log(\"Version cannot be less than zero\");\n    return null;\n  }\n\n  const padToTwo = (n: number) => (n <= 99 ? `0${n}`.slice(-2) : n);\n  const seed =\n    baseMint.toString().slice(0, 15) +\n    quoteMint.toString().slice(0, 15) +\n    padToTwo(version);\n  return await PublicKey.createWithSeed(WORM_MARKET_BASE, seed, DEX_PID);\n}\n\ntype Bbo = {\n  bestBid?: number;\n  bestOffer?: number;\n  mid?: number;\n};\n\nconst _ORDERBOOK_CACHE = new Map<string, Promise<Orderbook>>();\nconst _MARKET_CACHE = new Map<string, Promise<Market>>();\n","import * as assert from \"assert\";\nimport React, { useContext, useState } from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport { PublicKey } from \"@solana/web3.js\";\nimport {\n  Token,\n  ASSOCIATED_TOKEN_PROGRAM_ID,\n  TOKEN_PROGRAM_ID,\n} from \"@solana/spl-token\";\nimport { Market } from \"@project-serum/serum\";\nimport { SRM_MINT, USDC_MINT, USDT_MINT } from \"../utils/pubkeys\";\nimport { useFairRoute, useRouteVerbose, useDexContext } from \"./Dex\";\nimport {\n  useTokenListContext,\n  SPL_REGISTRY_SOLLET_TAG,\n  SPL_REGISTRY_WORM_TAG,\n} from \"./TokenList\";\n\nconst DEFAULT_SLIPPAGE_PERCENT = 0.5;\n\nexport type SwapContext = {\n  // Mint being traded from. The user must own these tokens.\n  fromMint: PublicKey;\n  setFromMint: (m: PublicKey) => void;\n\n  // Mint being traded to. The user will receive these tokens after the swap.\n  toMint: PublicKey;\n  setToMint: (m: PublicKey) => void;\n\n  // Amount used for the swap.\n  fromAmount: number;\n  setFromAmount: (a: number) => void;\n\n  // *Expected* amount received from the swap.\n  toAmount: number;\n  setToAmount: (a: number) => void;\n\n  // Function to flip what we consider to be the \"to\" and \"from\" mints.\n  swapToFromMints: () => void;\n\n  // The amount (in units of percent) a swap can be off from the estimate\n  // shown to the user.\n  slippage: number;\n  setSlippage: (n: number) => void;\n\n  // Null if the user is using fairs directly from DEX prices.\n  // Otherwise, a user specified override for the price to use when calculating\n  // swap amounts.\n  fairOverride: number | null;\n  setFairOverride: (n: number | null) => void;\n\n  // The referral *owner* address. Associated token accounts must be created,\n  // first, for this to be used.\n  referral?: PublicKey;\n\n  // True if all newly created market accounts should be closed in the\n  // same user flow (ideally in the same transaction).\n  isClosingNewAccounts: boolean;\n  setIsClosingNewAccounts: (b: boolean) => void;\n};\nconst _SwapContext = React.createContext<null | SwapContext>(null);\n\nexport function SwapContextProvider(props: any) {\n  const [fromMint, setFromMint] = useState(props.fromMint ?? SRM_MINT);\n  const [toMint, setToMint] = useState(props.toMint ?? USDC_MINT);\n  const [fromAmount, _setFromAmount] = useState(props.fromAmount ?? 0);\n  const [toAmount, _setToAmount] = useState(props.toAmount ?? 0);\n  const [isClosingNewAccounts, setIsClosingNewAccounts] = useState(false);\n  const [slippage, setSlippage] = useState(DEFAULT_SLIPPAGE_PERCENT);\n  const [fairOverride, setFairOverride] = useState<number | null>(null);\n  const fair = _useSwapFair(fromMint, toMint, fairOverride);\n  const referral = props.referral;\n\n  assert.ok(slippage >= 0);\n\n  const swapToFromMints = () => {\n    const oldFrom = fromMint;\n    const oldFromAmount = fromAmount;\n    const oldTo = toMint;\n    const oldToAmount = toAmount;\n    setFromMint(oldTo);\n    setToMint(oldFrom);\n    _setFromAmount(oldToAmount);\n    _setToAmount(oldFromAmount);\n  };\n\n  const setFromAmount = (amount: number) => {\n    if (fair === undefined) {\n      throw new Error(\"Fair price not found\");\n    }\n    _setFromAmount(amount);\n    _setToAmount(amount / fair);\n  };\n\n  const setToAmount = (amount: number) => {\n    if (fair === undefined) {\n      throw new Error(\"Fair price not found\");\n    }\n    _setToAmount(amount);\n    _setFromAmount(amount * fair);\n  };\n\n  return (\n    <_SwapContext.Provider\n      value={{\n        fromMint,\n        setFromMint,\n        toMint,\n        setToMint,\n        fromAmount,\n        setFromAmount,\n        toAmount,\n        setToAmount,\n        swapToFromMints,\n        slippage,\n        setSlippage,\n        fairOverride,\n        setFairOverride,\n        isClosingNewAccounts,\n        setIsClosingNewAccounts,\n        referral,\n      }}\n    >\n      {props.children}\n    </_SwapContext.Provider>\n  );\n}\n\nexport function useSwapContext(): SwapContext {\n  const ctx = useContext(_SwapContext);\n  if (ctx === null) {\n    throw new Error(\"Context not available\");\n  }\n  return ctx;\n}\n\nexport function useSwapFair(): number | undefined {\n  const { fairOverride, fromMint, toMint } = useSwapContext();\n  return _useSwapFair(fromMint, toMint, fairOverride);\n}\n\nfunction _useSwapFair(\n  fromMint: PublicKey,\n  toMint: PublicKey,\n  fairOverride: number | null\n): number | undefined {\n  const fairRoute = useFairRoute(fromMint, toMint);\n  const fair = fairOverride === null ? fairRoute : fairOverride;\n  return fair;\n}\n\n// Returns true if the user can swap with the current context.\nexport function useCanSwap(): boolean {\n  const { fromMint, toMint, fromAmount, toAmount } = useSwapContext();\n  const { swapClient } = useDexContext();\n  const { wormholeMap, solletMap } = useTokenListContext();\n  const route = useRouteVerbose(fromMint, toMint);\n  if (route === null) {\n    return false;\n  }\n\n  return (\n    // Mints are distinct.\n    fromMint.equals(toMint) === false &&\n    // Wallet is connected.\n    swapClient.program.provider.wallet.publicKey !== null &&\n    // Trade amounts greater than zero.\n    fromAmount > 0 &&\n    toAmount > 0 &&\n    // Trade route exists.\n    route !== null &&\n    // Wormhole <-> native markets must have the wormhole token as the\n    // *from* address since they're one-sided markets.\n    (route.kind !== \"wormhole-native\" ||\n      wormholeMap\n        .get(fromMint.toString())\n        ?.tags?.includes(SPL_REGISTRY_WORM_TAG) !== undefined) &&\n    // Wormhole <-> sollet markets must have the sollet token as the\n    // *from* address since they're one sided markets.\n    (route.kind !== \"wormhole-sollet\" ||\n      solletMap\n        .get(fromMint.toString())\n        ?.tags?.includes(SPL_REGISTRY_SOLLET_TAG) !== undefined)\n  );\n}\n\nexport function useReferral(fromMarket?: Market): PublicKey | undefined {\n  const { referral } = useSwapContext();\n  const asyncReferral = useAsync(async () => {\n    if (!referral) {\n      return undefined;\n    }\n    if (!fromMarket) {\n      return undefined;\n    }\n    if (\n      !fromMarket.quoteMintAddress.equals(USDC_MINT) &&\n      !fromMarket.quoteMintAddress.equals(USDT_MINT)\n    ) {\n      return undefined;\n    }\n\n    return Token.getAssociatedTokenAddress(\n      ASSOCIATED_TOKEN_PROGRAM_ID,\n      TOKEN_PROGRAM_ID,\n      fromMarket.quoteMintAddress,\n      referral\n    );\n  }, [fromMarket]);\n\n  if (!asyncReferral.result) {\n    return undefined;\n  }\n  return asyncReferral.result;\n}\n","// TODO: replace this whole file with something more modern. This is all copied\n//       from sollet.\n\nimport * as BufferLayout from \"buffer-layout\";\nimport { BN } from \"@project-serum/anchor\";\nimport {\n  TOKEN_PROGRAM_ID,\n  AccountInfo as TokenAccount,\n} from \"@solana/spl-token\";\nimport { Connection, PublicKey } from \"@solana/web3.js\";\nimport * as bs58 from \"bs58\";\n\nexport async function getOwnedTokenAccounts(\n  connection: Connection,\n  publicKey: PublicKey\n) {\n  let filters = getOwnedAccountsFilters(publicKey);\n  // @ts-ignore\n  let resp = await connection._rpcRequest(\"getProgramAccounts\", [\n    TOKEN_PROGRAM_ID.toBase58(),\n    {\n      commitment: connection.commitment,\n      filters,\n    },\n  ]);\n  if (resp.error) {\n    throw new Error(\n      \"failed to get token accounts owned by \" +\n        publicKey.toBase58() +\n        \": \" +\n        resp.error.message\n    );\n  }\n  return resp.result\n    .map(({ pubkey, account: { data, executable, owner, lamports } }: any) => ({\n      publicKey: new PublicKey(pubkey),\n      accountInfo: {\n        data: bs58.decode(data),\n        executable,\n        owner: new PublicKey(owner),\n        lamports,\n      },\n    }))\n    .filter(({ accountInfo }: any) => {\n      // TODO: remove this check once mainnet is updated\n      return filters.every((filter) => {\n        if (filter.dataSize) {\n          return accountInfo.data.length === filter.dataSize;\n        } else if (filter.memcmp) {\n          let filterBytes = bs58.decode(filter.memcmp.bytes);\n          return accountInfo.data\n            .slice(\n              filter.memcmp.offset,\n              filter.memcmp.offset + filterBytes.length\n            )\n            .equals(filterBytes);\n        }\n        return false;\n      });\n    })\n    .map(({ publicKey, accountInfo }: any) => {\n      return { publicKey, account: parseTokenAccountData(accountInfo.data) };\n    });\n}\n\nconst ACCOUNT_LAYOUT = BufferLayout.struct([\n  BufferLayout.blob(32, \"mint\"),\n  BufferLayout.blob(32, \"owner\"),\n  BufferLayout.nu64(\"amount\"),\n  BufferLayout.blob(93),\n]);\n\nconst MINT_LAYOUT = BufferLayout.struct([\n  BufferLayout.blob(44),\n  BufferLayout.u8(\"decimals\"),\n  BufferLayout.blob(37),\n]);\n\nexport function parseTokenAccountData(data: Buffer): TokenAccount {\n  // @ts-ignore\n  let { mint, owner, amount } = ACCOUNT_LAYOUT.decode(data);\n  // @ts-ignore\n  return {\n    mint: new PublicKey(mint),\n    owner: new PublicKey(owner),\n    amount: new BN(amount),\n  };\n}\n\nexport function parseMintData(data: Buffer) {\n  // @ts-ignore\n  let { decimals } = MINT_LAYOUT.decode(data);\n  return { decimals };\n}\n\nfunction getOwnedAccountsFilters(publicKey: PublicKey) {\n  return [\n    {\n      memcmp: {\n        // @ts-ignore\n        offset: ACCOUNT_LAYOUT.offsetOf(\"owner\"),\n        bytes: publicKey.toBase58(),\n      },\n    },\n    {\n      dataSize: ACCOUNT_LAYOUT.span,\n    },\n  ];\n}\n","import React, { useContext, useState, useEffect } from \"react\";\nimport * as assert from \"assert\";\nimport { useAsync } from \"react-async-hook\";\nimport { Provider } from \"@project-serum/anchor\";\nimport { PublicKey, Account } from \"@solana/web3.js\";\nimport {\n  MintInfo,\n  AccountInfo as TokenAccount,\n  Token,\n  TOKEN_PROGRAM_ID,\n} from \"@solana/spl-token\";\nimport { getOwnedTokenAccounts, parseTokenAccountData } from \"../utils/tokens\";\n\nexport type TokenContext = {\n  provider: Provider;\n};\nconst _TokenContext = React.createContext<TokenContext | null>(null);\n\nexport function TokenContextProvider(props: any) {\n  const provider = props.provider;\n  const [, setRefresh] = useState(0);\n\n  // Fetch all the owned token accounts for the wallet.\n  useEffect(() => {\n    if (!provider.wallet.publicKey) {\n      _OWNED_TOKEN_ACCOUNTS_CACHE.length = 0;\n      setRefresh((r) => r + 1);\n      return;\n    }\n    getOwnedTokenAccounts(provider.connection, provider.wallet.publicKey).then(\n      (accs) => {\n        if (accs) {\n          _OWNED_TOKEN_ACCOUNTS_CACHE.push(...accs);\n          setRefresh((r) => r + 1);\n        }\n      }\n    );\n  }, [provider.wallet.publicKey, provider.connection]);\n\n  return (\n    <_TokenContext.Provider\n      value={{\n        provider,\n      }}\n    >\n      {props.children}\n    </_TokenContext.Provider>\n  );\n}\n\nfunction useTokenContext() {\n  const ctx = useContext(_TokenContext);\n  if (ctx === null) {\n    throw new Error(\"Context not available\");\n  }\n  return ctx;\n}\n\n// Null => none exists.\n// Undefined => loading.\nexport function useOwnedTokenAccount(\n  mint?: PublicKey\n): { publicKey: PublicKey; account: TokenAccount } | null | undefined {\n  const { provider } = useTokenContext();\n  const [, setRefresh] = useState(0);\n  const tokenAccounts = _OWNED_TOKEN_ACCOUNTS_CACHE.filter(\n    (account) => mint && account.account.mint.equals(mint)\n  );\n\n  // Take the account with the most tokens in it.\n  tokenAccounts.sort((a, b) =>\n    a.account.amount < b.account.amount\n      ? -1\n      : a.account.amount > b.account.amount\n      ? 1\n      : 0\n  );\n\n  const tokenAccount = tokenAccounts[0];\n\n  // Stream updates when the balance changes.\n  useEffect(() => {\n    let listener: number;\n    if (tokenAccount) {\n      listener = provider.connection.onAccountChange(\n        tokenAccount.publicKey,\n        (info) => {\n          const token = parseTokenAccountData(info.data);\n          if (token.amount !== tokenAccount.account.amount) {\n            const index = _OWNED_TOKEN_ACCOUNTS_CACHE.indexOf(tokenAccount);\n            assert.ok(index >= 0);\n            _OWNED_TOKEN_ACCOUNTS_CACHE[index].account = token;\n            setRefresh((r) => r + 1);\n          }\n        }\n      );\n    }\n    return () => {\n      if (listener) {\n        provider.connection.removeAccountChangeListener(listener);\n      }\n    };\n  }, [provider.connection, tokenAccount]);\n\n  if (mint === undefined) {\n    return undefined;\n  }\n\n  if (tokenAccounts.length === 0) {\n    return null;\n  }\n\n  return tokenAccount;\n}\n\nexport function useMint(mint?: PublicKey): MintInfo | undefined | null {\n  const { provider } = useTokenContext();\n  // Lazy load the mint account if needeed.\n  const asyncMintInfo = useAsync(async () => {\n    if (!mint) {\n      return undefined;\n    }\n    if (_MINT_CACHE.get(mint.toString())) {\n      return _MINT_CACHE.get(mint.toString());\n    }\n\n    const mintClient = new Token(\n      provider.connection,\n      mint,\n      TOKEN_PROGRAM_ID,\n      new Account()\n    );\n    const mintInfo = mintClient.getMintInfo();\n    _MINT_CACHE.set(mint.toString(), mintInfo);\n    return mintInfo;\n  }, [provider.connection, mint]);\n\n  if (asyncMintInfo.result) {\n    return asyncMintInfo.result;\n  }\n  return undefined;\n}\n\n// Cache storing all token accounts for the connected wallet provider.\nconst _OWNED_TOKEN_ACCOUNTS_CACHE: Array<{\n  publicKey: PublicKey;\n  account: TokenAccount;\n}> = [];\n\n// Cache storing all previously fetched mint infos.\nconst _MINT_CACHE = new Map<string, Promise<MintInfo>>();\n","import { useState } from \"react\";\nimport { PublicKey } from \"@solana/web3.js\";\nimport { TokenInfo } from \"@solana/spl-token-registry\";\nimport {\n  makeStyles,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  TextField,\n  List,\n  ListItem,\n  Typography,\n  Tabs,\n  Tab,\n} from \"@material-ui/core\";\nimport { TokenIcon } from \"./Swap\";\nimport { useSwappableTokens } from \"../context/TokenList\";\n\nconst useStyles = makeStyles(() => ({\n  dialogContent: {\n    paddingTop: 0,\n    paddingBottom: 0,\n  },\n  textField: {\n    width: \"100%\",\n    border: \"solid 1pt #ccc\",\n    borderRadius: \"10px\",\n    marginBottom: \"8px\",\n  },\n  tab: {\n    minWidth: \"134px\",\n  },\n}));\n\nexport default function TokenDialog({\n  open,\n  onClose,\n  setMint,\n}: {\n  open: boolean;\n  onClose: () => void;\n  setMint: (mint: PublicKey) => void;\n}) {\n  const [tabSelection, setTabSelection] = useState(0);\n  const [tokenFilter, setTokenFilter] = useState(\"\");\n  const filter = tokenFilter.toLowerCase();\n  const styles = useStyles();\n  const { swappableTokens, swappableTokensSollet, swappableTokensWormhole } =\n    useSwappableTokens();\n  const selectedTokens =\n    tabSelection === 0\n      ? swappableTokens\n      : tabSelection === 1\n      ? swappableTokensWormhole\n      : swappableTokensSollet;\n  let tokens =\n    tokenFilter === \"\"\n      ? selectedTokens\n      : selectedTokens.filter(\n          (t) =>\n            t.symbol.toLowerCase().startsWith(filter) ||\n            t.name.toLowerCase().startsWith(filter) ||\n            t.address.toLowerCase().startsWith(filter)\n        );\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      scroll={\"paper\"}\n      PaperProps={{\n        style: {\n          borderRadius: \"10px\",\n          width: \"420px\",\n        },\n      }}\n    >\n      <DialogTitle style={{ fontWeight: \"bold\" }}>\n        <Typography variant=\"h6\" style={{ paddingBottom: \"16px\" }}>\n          Select a token\n        </Typography>\n        <TextField\n          className={styles.textField}\n          placeholder={\"Search name\"}\n          value={tokenFilter}\n          onChange={(e) => setTokenFilter(e.target.value)}\n          InputProps={{\n            disableUnderline: true,\n            style: { padding: \"10px\" },\n          }}\n        />\n      </DialogTitle>\n      <DialogContent className={styles.dialogContent} dividers={true}>\n        <List disablePadding>\n          {tokens.map((tokenInfo: TokenInfo) => (\n            <TokenListItem\n              key={tokenInfo.address}\n              tokenInfo={tokenInfo}\n              onClick={(mint) => {\n                setMint(mint);\n                onClose();\n              }}\n            />\n          ))}\n        </List>\n      </DialogContent>\n      <DialogActions>\n        <Tabs value={tabSelection} onChange={(e, v) => setTabSelection(v)}>\n          <Tab value={0} className={styles.tab} label=\"Main\" />\n          <Tab value={1} className={styles.tab} label=\"Wormhole\" />\n          <Tab value={2} className={styles.tab} label=\"Sollet\" />\n        </Tabs>\n      </DialogActions>\n    </Dialog>\n  );\n}\n\nfunction TokenListItem({\n  tokenInfo,\n  onClick,\n}: {\n  tokenInfo: TokenInfo;\n  onClick: (mint: PublicKey) => void;\n}) {\n  const mint = new PublicKey(tokenInfo.address);\n  return (\n    <ListItem button onClick={() => onClick(mint)}>\n      <TokenIcon mint={mint} style={{ width: \"30px\", borderRadius: \"15px\" }} />\n      <TokenName tokenInfo={tokenInfo} />\n    </ListItem>\n  );\n}\n\nfunction TokenName({ tokenInfo }: { tokenInfo: TokenInfo }) {\n  return (\n    <div style={{ marginLeft: \"16px\" }}>\n      <Typography style={{ fontWeight: \"bold\" }}>\n        {tokenInfo?.symbol}\n      </Typography>\n      <Typography color=\"textSecondary\" style={{ fontSize: \"14px\" }}>\n        {tokenInfo?.name}\n      </Typography>\n    </div>\n  );\n}\n","import { useState, useMemo } from \"react\";\nimport { PublicKey } from \"@solana/web3.js\";\nimport { MintInfo } from \"@solana/spl-token\";\nimport { BN } from \"@project-serum/anchor\";\nimport { OpenOrders } from \"@project-serum/serum\";\nimport {\n  makeStyles,\n  Dialog,\n  DialogContent,\n  Paper,\n  Table,\n  TableRow,\n  TableHead,\n  TableCell,\n  TableBody,\n  TableContainer,\n  IconButton,\n  Typography,\n  Button,\n  Select,\n  MenuItem,\n  Link,\n} from \"@material-ui/core\";\nimport { Close } from \"@material-ui/icons\";\nimport { useMarket, useOpenOrders, useDexContext } from \"../context/Dex\";\nimport { useTokenMap } from \"../context/TokenList\";\nimport { useMint, useOwnedTokenAccount } from \"../context/Token\";\n\nconst useStyles = makeStyles((theme) => ({\n  table: {},\n  closeAccountSwitchLabel: {\n    color: theme.palette.text.secondary,\n  },\n}));\n\nexport default function OpenOrdersDialog({\n  open,\n  onClose,\n}: {\n  open: boolean;\n  onClose: () => void;\n}) {\n  return (\n    <Dialog\n      maxWidth=\"lg\"\n      open={open}\n      onClose={onClose}\n      PaperProps={{\n        style: {\n          borderRadius: \"10px\",\n        },\n      }}\n    >\n      <div>\n        <div\n          style={{\n            height: \"24px\",\n            display: \"flex\",\n            justifyContent: \"space-between\",\n          }}\n        >\n          <IconButton\n            onClick={onClose}\n            style={{\n              padding: 0,\n              position: \"absolute\",\n              right: \"8px\",\n              top: \"8px\",\n            }}\n          >\n            <Close />\n          </IconButton>\n        </div>\n        <DialogContent style={{ paddingTop: 0 }}>\n          <OpenOrdersAccounts />\n        </DialogContent>\n      </div>\n    </Dialog>\n  );\n}\n\nfunction OpenOrdersAccounts() {\n  const styles = useStyles();\n  const openOrders = useOpenOrders();\n  const openOrdersEntries: Array<[PublicKey, OpenOrders[]]> = useMemo(() => {\n    return Array.from(openOrders.entries()).map(([market, oo]) => [\n      new PublicKey(market),\n      oo,\n    ]);\n  }, [openOrders]);\n  return (\n    <TableContainer component={Paper} elevation={0}>\n      <Table className={styles.table} aria-label=\"simple table\">\n        <TableHead>\n          <TableRow>\n            <TableCell>Market</TableCell>\n            <TableCell align=\"center\">Open Orders Account</TableCell>\n            <TableCell align=\"center\">Base Used</TableCell>\n            <TableCell align=\"center\">Base Free</TableCell>\n            <TableCell align=\"center\">Quote Used</TableCell>\n            <TableCell align=\"center\">Quote Free</TableCell>\n            <TableCell align=\"center\">Settle</TableCell>\n            <TableCell align=\"center\">Close</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {openOrdersEntries.map(([market, oos]) => {\n            return (\n              <OpenOrdersRow\n                key={market.toString()}\n                market={market}\n                openOrders={oos}\n              />\n            );\n          })}\n        </TableBody>\n      </Table>\n    </TableContainer>\n  );\n}\n\nfunction OpenOrdersRow({\n  market,\n  openOrders,\n}: {\n  market: PublicKey;\n  openOrders: Array<OpenOrders>;\n}) {\n  const [ooAccount, setOoAccount] = useState(openOrders[0]);\n  const { swapClient } = useDexContext();\n  const marketClient = useMarket(market);\n  const tokenMap = useTokenMap();\n  const base = useMint(marketClient?.baseMintAddress);\n  const quote = useMint(marketClient?.quoteMintAddress);\n  const baseWallet = useOwnedTokenAccount(marketClient?.baseMintAddress);\n  const quoteWallet = useOwnedTokenAccount(marketClient?.quoteMintAddress);\n  const baseTicker = marketClient\n    ? tokenMap.get(marketClient?.baseMintAddress.toString())?.symbol\n    : \"-\";\n  const quoteTicker = marketClient\n    ? tokenMap.get(marketClient?.quoteMintAddress.toString())?.symbol\n    : \"-\";\n  const marketName =\n    baseTicker && quoteTicker\n      ? `${baseTicker} / ${quoteTicker}`\n      : market.toString();\n  const settleDisabled =\n    ooAccount.baseTokenFree.toNumber() + ooAccount.quoteTokenFree.toNumber() ===\n    0;\n  const closeDisabled =\n    ooAccount.baseTokenTotal.toNumber() +\n      ooAccount.quoteTokenTotal.toNumber() !==\n    0;\n\n  const settleFunds = async () => {\n    if (!marketClient) {\n      throw new Error(\"Market client not found\");\n    }\n    if (!baseWallet || !quoteWallet) {\n      throw new Error(\"Base or quote wallet not found\");\n    }\n    const referrerWallet = undefined;\n    const { transaction, signers } =\n      await marketClient.makeSettleFundsTransaction(\n        swapClient.program.provider.connection,\n        ooAccount,\n        baseWallet.publicKey,\n        quoteWallet.publicKey,\n        referrerWallet\n      );\n    await swapClient.program.provider.send(transaction, signers);\n  };\n\n  const closeOpenOrders = async () => {\n    // TODO.\n    //\n    // Blocked by https://github.com/project-serum/serum-dex/pull/112.\n  };\n\n  return (\n    <TableRow key={market.toString()}>\n      <TableCell component=\"th\" scope=\"row\">\n        <Typography>\n          <Link\n            href={`https://dex.projectserum.com/#/market/${market.toString()}`}\n            target=\"_blank\"\n            rel=\"noopener\"\n          >\n            {marketName}\n          </Link>\n        </Typography>\n      </TableCell>\n      <TableCell align=\"center\">\n        <Select\n          value={ooAccount.address.toString()}\n          onChange={(e) =>\n            setOoAccount(\n              openOrders.filter(\n                (oo) => oo.address.toString() === e.target.value\n              )[0]\n            )\n          }\n        >\n          {openOrders.map((oo) => {\n            return (\n              <MenuItem\n                key={oo.address.toString()}\n                value={oo.address.toString()}\n              >\n                {oo.address.toString()}\n              </MenuItem>\n            );\n          })}\n        </Select>\n      </TableCell>\n      <TableCell align=\"center\">\n        {toDisplay(base, ooAccount.baseTokenTotal.sub(ooAccount.baseTokenFree))}\n      </TableCell>\n      <TableCell align=\"center\">\n        {toDisplay(base, ooAccount.baseTokenFree)}\n      </TableCell>\n      <TableCell align=\"center\">\n        {toDisplay(\n          quote,\n          ooAccount.quoteTokenTotal.sub(ooAccount.quoteTokenFree)\n        )}\n      </TableCell>\n      <TableCell align=\"center\">\n        {toDisplay(quote, ooAccount.quoteTokenFree)}\n      </TableCell>\n      <TableCell align=\"center\">\n        <Button color=\"primary\" disabled={settleDisabled} onClick={settleFunds}>\n          Settle\n        </Button>\n      </TableCell>\n      <TableCell align=\"center\">\n        <Button\n          color=\"secondary\"\n          disabled={closeDisabled}\n          onClick={closeOpenOrders}\n        >\n          Close\n        </Button>\n      </TableCell>\n    </TableRow>\n  );\n}\n\nfunction toDisplay(mintInfo: MintInfo | undefined | null, value: BN): string {\n  if (!mintInfo) {\n    return value.toNumber().toString();\n  }\n  return (value.toNumber() / 10 ** mintInfo.decimals).toFixed(\n    mintInfo.decimals\n  );\n}\n","import { useState } from \"react\";\nimport {\n  makeStyles,\n  Popover,\n  IconButton,\n  Typography,\n  Button,\n  TextField,\n  InputAdornment,\n  Switch,\n  FormControlLabel,\n  FormGroup,\n} from \"@material-ui/core\";\nimport { ToggleButton } from \"@material-ui/lab\";\nimport { SettingsOutlined as Settings } from \"@material-ui/icons\";\nimport PopupState, { bindTrigger, bindPopover } from \"material-ui-popup-state\";\nimport { useSwapContext, useSwapFair } from \"../context/Swap\";\nimport { useDexContext } from \"../context/Dex\";\nimport OpenOrdersDialog from \"./OpenOrdersDialog\";\n\nconst useStyles = makeStyles((theme) => ({\n  tab: {\n    width: \"50%\",\n  },\n  table: {},\n  settingsButton: {\n    padding: 0,\n  },\n  closeAccountSwitchLabel: {\n    color: theme.palette.text.secondary,\n  },\n}));\n\nexport function SettingsButton() {\n  const styles = useStyles();\n\n  return (\n    <PopupState variant=\"popover\">\n      {\n        //@ts-ignore\n        (popupState) => (\n          <div>\n            <IconButton\n              {...bindTrigger(popupState)}\n              className={styles.settingsButton}\n            >\n              <Settings />\n            </IconButton>\n            <Popover\n              {...bindPopover(popupState)}\n              anchorOrigin={{\n                vertical: \"bottom\",\n                horizontal: \"left\",\n              }}\n              transformOrigin={{\n                vertical: \"top\",\n                horizontal: \"right\",\n              }}\n              PaperProps={{ style: { borderRadius: \"10px\" } }}\n            >\n              <SettingsDetails />\n            </Popover>\n          </div>\n        )\n      }\n    </PopupState>\n  );\n}\n\nfunction SettingsDetails() {\n  const { slippage, setSlippage, fairOverride, setFairOverride } =\n    useSwapContext();\n  const [showSettingsDialog, setShowSettingsDialog] = useState(false);\n  const fair = useSwapFair();\n  const { swapClient } = useDexContext();\n\n  const setSlippageHandler = (value?: number) => {\n    setSlippage(!value || value < 0 ? 0 : value);\n  };\n\n  return (\n    <div style={{ padding: \"15px\", width: \"305px\" }}>\n      <Typography color=\"textSecondary\" style={{ fontWeight: \"bold\" }}>\n        Settings\n      </Typography>\n      <div style={{ marginTop: \"10px\" }}>\n        <div>\n          <Typography color=\"textSecondary\">Slippage tolerance</Typography>\n          <TextField\n            type=\"number\"\n            placeholder=\"Error tolerance percentage\"\n            value={slippage}\n            onChange={(e) => setSlippageHandler(parseFloat(e.target.value))}\n            style={{\n              display: \"flex\",\n              justifyContent: \"center\",\n              flexDirection: \"column\",\n            }}\n            InputProps={{\n              endAdornment: <InputAdornment position=\"end\">%</InputAdornment>,\n            }}\n          />\n        </div>\n        <div style={{ marginTop: \"5px\" }}>\n          <Typography color=\"textSecondary\">Fair price</Typography>\n          <div style={{ display: \"flex\" }}>\n            <TextField\n              type=\"number\"\n              placeholder=\"Fair price override\"\n              value={fair}\n              onChange={(e) => setFairOverride(parseFloat(e.target.value))}\n              style={{\n                marginRight: \"10px\",\n                flex: 1,\n                display: \"flex\",\n                justifyContent: \"center\",\n                flexDirection: \"column\",\n              }}\n              disabled={fairOverride === null}\n            />\n            <ToggleButton\n              value=\"bold\"\n              selected={fairOverride === null}\n              onClick={() => {\n                if (fair === undefined) {\n                  console.error(\"Fair is undefined\");\n                  return;\n                }\n                if (fairOverride === null) {\n                  setFairOverride(fair);\n                } else {\n                  setFairOverride(null);\n                }\n              }}\n              style={{\n                paddingTop: \"3px\",\n                paddingBottom: \"3px\",\n                paddingLeft: \"5px\",\n                paddingRight: \"5px\",\n                borderRadius: \"20px\",\n              }}\n            >\n              Auto\n            </ToggleButton>\n          </div>\n        </div>\n        <div style={{ marginTop: \"5px\" }}>\n          <CloseNewAccountsSwitch />\n        </div>\n        <Button\n          style={{\n            width: \"100%\",\n            marginTop: \"10px\",\n            background: \"#e0e0e0\",\n          }}\n          disabled={swapClient.program.provider.wallet.publicKey === null}\n          onClick={() => setShowSettingsDialog(true)}\n        >\n          Manage Dex Accounts\n        </Button>\n      </div>\n      <OpenOrdersDialog\n        open={showSettingsDialog}\n        onClose={() => setShowSettingsDialog(false)}\n      />\n    </div>\n  );\n}\n\nfunction CloseNewAccountsSwitch() {\n  const styles = useStyles();\n  const { isClosingNewAccounts, setIsClosingNewAccounts } = useSwapContext();\n\n  return (\n    <FormGroup row>\n      <FormControlLabel\n        classes={{ label: styles.closeAccountSwitchLabel }}\n        labelPlacement=\"start\"\n        style={{\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          marginLeft: 0,\n          width: \"100%\",\n        }}\n        control={\n          <Switch\n            checked={isClosingNewAccounts}\n            onChange={() => setIsClosingNewAccounts(!isClosingNewAccounts)}\n            color=\"primary\"\n          />\n        }\n        label=\"Close new accounts\"\n      />\n    </FormGroup>\n  );\n}\n","import {\n  makeStyles,\n  Typography,\n  Link,\n  Popover,\n  IconButton,\n} from \"@material-ui/core\";\nimport { Info } from \"@material-ui/icons\";\nimport PopupState, { bindTrigger, bindPopover } from \"material-ui-popup-state\";\nimport { PublicKey } from \"@solana/web3.js\";\nimport { useTokenMap } from \"../context/TokenList\";\nimport { useSwapContext, useSwapFair } from \"../context/Swap\";\nimport { useMint } from \"../context/Token\";\nimport { useRoute, useMarketName, useBbo } from \"../context/Dex\";\n\nconst useStyles = makeStyles((theme) => ({\n  infoLabel: {\n    marginTop: \"10px\",\n    marginBottom: \"10px\",\n    display: \"flex\",\n    justifyContent: \"space-between\",\n    marginLeft: \"5px\",\n    marginRight: \"5px\",\n  },\n  fairPriceLabel: {\n    marginRight: \"10px\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    flexDirection: \"column\",\n    color: theme.palette.text.secondary,\n  },\n  infoButton: {\n    padding: 0,\n  },\n}));\n\nexport function InfoLabel() {\n  const styles = useStyles();\n\n  const { fromMint, toMint } = useSwapContext();\n  const fromMintInfo = useMint(fromMint);\n  const fair = useSwapFair();\n\n  const tokenMap = useTokenMap();\n  let fromTokenInfo = tokenMap.get(fromMint.toString());\n  let toTokenInfo = tokenMap.get(toMint.toString());\n\n  return (\n    <div className={styles.infoLabel}>\n      <Typography color=\"textSecondary\"></Typography>\n      <div style={{ display: \"flex\" }}>\n        <div className={styles.fairPriceLabel}>\n          {fair !== undefined && toTokenInfo && fromTokenInfo\n            ? `1 ${toTokenInfo.symbol} = ${fair.toFixed(\n                fromMintInfo?.decimals\n              )} ${fromTokenInfo.symbol}`\n            : `-`}\n        </div>\n        <InfoButton />\n      </div>\n    </div>\n  );\n}\n\nfunction InfoButton() {\n  const styles = useStyles();\n  return (\n    <PopupState variant=\"popover\">\n      {\n        //@ts-ignore\n        (popupState) => (\n          <div style={{ display: \"flex\" }}>\n            <IconButton\n              {...bindTrigger(popupState)}\n              className={styles.infoButton}\n            >\n              <Info />\n            </IconButton>\n            <Popover\n              {...bindPopover(popupState)}\n              anchorOrigin={{\n                vertical: \"bottom\",\n                horizontal: \"left\",\n              }}\n              transformOrigin={{\n                vertical: \"top\",\n                horizontal: \"right\",\n              }}\n              PaperProps={{ style: { borderRadius: \"10px\" } }}\n              disableRestoreFocus\n            >\n              <InfoDetails />\n            </Popover>\n          </div>\n        )\n      }\n    </PopupState>\n  );\n}\n\nfunction InfoDetails() {\n  const { fromMint, toMint } = useSwapContext();\n  const route = useRoute(fromMint, toMint);\n  const tokenMap = useTokenMap();\n  const fromMintTicker = tokenMap.get(fromMint.toString())?.symbol;\n  const toMintTicker = tokenMap.get(toMint.toString())?.symbol;\n  const addresses = [\n    { ticker: fromMintTicker, mint: fromMint },\n    { ticker: toMintTicker, mint: toMint },\n  ];\n\n  return (\n    <div style={{ padding: \"15px\", width: \"250px\" }}>\n      <div>\n        <Typography\n          color=\"textSecondary\"\n          style={{ fontWeight: \"bold\", marginBottom: \"5px\" }}\n        >\n          Trade Route\n        </Typography>\n        {route ? (\n          route.map((market: PublicKey) => {\n            return <MarketRoute key={market.toString()} market={market} />;\n          })\n        ) : (\n          <Typography color=\"textSecondary\">Route not found</Typography>\n        )}\n      </div>\n      <div style={{ marginTop: \"15px\" }}>\n        <Typography\n          color=\"textSecondary\"\n          style={{ fontWeight: \"bold\", marginBottom: \"5px\" }}\n        >\n          Tokens\n        </Typography>\n        {addresses.map((address) => {\n          return (\n            <div\n              key={address.mint.toString()}\n              style={{\n                marginTop: \"5px\",\n                display: \"flex\",\n                justifyContent: \"space-between\",\n              }}\n            >\n              <Link\n                href={`https://explorer.solana.com/address/${address.mint.toString()}`}\n                target=\"_blank\"\n                rel=\"noopener\"\n              >\n                {address.ticker}\n              </Link>\n              <code style={{ width: \"128px\", overflow: \"hidden\" }}>\n                {address.mint.toString()}\n              </code>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\nfunction MarketRoute({ market }: { market: PublicKey }) {\n  const marketName = useMarketName(market);\n  const bbo = useBbo(market);\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        justifyContent: \"space-between\",\n        marginTop: \"5px\",\n      }}\n    >\n      <Link\n        href={`https://dex.projectserum.com/#/market/${market.toString()}`}\n        target=\"_blank\"\n        rel=\"noopener\"\n      >\n        {marketName}\n      </Link>\n      <code style={{ marginLeft: \"10px\" }}>\n        {bbo && bbo.mid ? bbo.mid.toFixed(6) : \"-\"}\n      </code>\n    </div>\n  );\n}\n","import { useState } from \"react\";\nimport { PublicKey } from \"@solana/web3.js\";\nimport { BN } from \"@project-serum/anchor\";\nimport {\n  makeStyles,\n  Card,\n  Button,\n  Paper,\n  Typography,\n  TextField,\n} from \"@material-ui/core\";\nimport { ExpandMore } from \"@material-ui/icons\";\nimport { useSwapContext, useSwapFair } from \"../context/Swap\";\nimport {\n  useDexContext,\n  useOpenOrders,\n  useRouteVerbose,\n  useMarket,\n  BASE_TAKER_FEE_BPS,\n} from \"../context/Dex\";\nimport { useTokenMap } from \"../context/TokenList\";\nimport { useMint, useOwnedTokenAccount } from \"../context/Token\";\nimport { useCanSwap, useReferral } from \"../context/Swap\";\nimport TokenDialog from \"./TokenDialog\";\nimport { SettingsButton } from \"./Settings\";\nimport { InfoLabel } from \"./Info\";\n\nconst useStyles = makeStyles(() => ({\n  card: {\n    width: \"450px\",\n    borderRadius: \"10px\",\n    border: \"solid 1pt #e0e0e0\",\n  },\n  cardContent: {\n    marginLeft: \"6px\",\n    marginRight: \"6px\",\n    marginBottom: \"6px\",\n  },\n  tab: {\n    width: \"50%\",\n  },\n  settingsButton: {\n    padding: 0,\n  },\n  swapButton: {\n    width: \"100%\",\n    borderRadius: \"15px\",\n  },\n  swapToFromButton: {\n    display: \"block\",\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n  },\n}));\n\nexport default function SwapCard({ style }: { style?: any }) {\n  const styles = useStyles();\n  return (\n    <div style={style}>\n      <Card className={styles.card}>\n        <SwapHeader />\n        <div className={styles.cardContent}>\n          <SwapFromForm />\n          <ArrowButton />\n          <SwapToForm />\n          <InfoLabel />\n          <SwapButton />\n        </div>\n      </Card>\n    </div>\n  );\n}\n\nfunction SwapHeader() {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        justifyContent: \"space-between\",\n        margin: \"8px\",\n      }}\n    >\n      <Typography\n        style={{\n          fontWeight: \"bold\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          flexDirection: \"column\",\n        }}\n      >\n        Swap\n      </Typography>\n      <SettingsButton />\n    </div>\n  );\n}\n\nexport function ArrowButton() {\n  const styles = useStyles();\n  const { swapToFromMints } = useSwapContext();\n  return (\n    <Button className={styles.swapToFromButton} onClick={swapToFromMints}>\n      ⇅\n    </Button>\n  );\n}\n\nfunction SwapFromForm() {\n  const { fromMint, setFromMint, fromAmount, setFromAmount } = useSwapContext();\n  return (\n    <SwapTokenForm\n      mint={fromMint}\n      setMint={setFromMint}\n      amount={fromAmount}\n      setAmount={setFromAmount}\n    />\n  );\n}\n\nfunction SwapToForm() {\n  const { toMint, setToMint, toAmount, setToAmount } = useSwapContext();\n  return (\n    <SwapTokenForm\n      mint={toMint}\n      setMint={setToMint}\n      amount={toAmount}\n      setAmount={setToAmount}\n    />\n  );\n}\n\nfunction SwapTokenForm({\n  mint,\n  setMint,\n  amount,\n  setAmount,\n}: {\n  mint: PublicKey;\n  setMint: (m: PublicKey) => void;\n  amount: number;\n  setAmount: (a: number) => void;\n}) {\n  const [showTokenDialog, setShowTokenDialog] = useState(false);\n  const tokenAccount = useOwnedTokenAccount(mint);\n  const mintAccount = useMint(mint);\n\n  return (\n    <Paper elevation={0} variant=\"outlined\" style={{ borderRadius: \"10px\" }}>\n      <div\n        style={{\n          height: \"50px\",\n          display: \"flex\",\n          justifyContent: \"space-between\",\n        }}\n      >\n        <TokenButton mint={mint} onClick={() => setShowTokenDialog(true)} />\n        <TextField\n          type=\"number\"\n          value={amount}\n          onChange={(e) => setAmount(parseFloat(e.target.value))}\n          style={{\n            display: \"flex\",\n            justifyContent: \"center\",\n            flexDirection: \"column\",\n          }}\n        />\n      </div>\n      <div style={{ marginLeft: \"10px\", height: \"30px\" }}>\n        <Typography color=\"textSecondary\" style={{ fontSize: \"14px\" }}>\n          {tokenAccount && mintAccount\n            ? `Balance: ${(\n                tokenAccount.account.amount.toNumber() /\n                10 ** mintAccount.decimals\n              ).toFixed(mintAccount.decimals)}`\n            : `-`}\n        </Typography>\n      </div>\n      <TokenDialog\n        setMint={setMint}\n        open={showTokenDialog}\n        onClose={() => setShowTokenDialog(false)}\n      />\n    </Paper>\n  );\n}\n\nfunction TokenButton({\n  mint,\n  onClick,\n}: {\n  mint: PublicKey;\n  onClick: () => void;\n}) {\n  return (\n    <Button onClick={onClick} style={{ minWidth: \"116px\" }}>\n      <TokenIcon mint={mint} style={{ width: \"25px\", borderRadius: \"13px\" }} />\n      <TokenName mint={mint} />\n      <ExpandMore />\n    </Button>\n  );\n}\n\nexport function TokenIcon({ mint, style }: { mint: PublicKey; style: any }) {\n  const tokenMap = useTokenMap();\n  let tokenInfo = tokenMap.get(mint.toString());\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        justifyContent: \"center\",\n        flexDirection: \"column\",\n      }}\n    >\n      {tokenInfo?.logoURI ? (\n        <img alt=\"Logo\" style={style} src={tokenInfo?.logoURI} />\n      ) : (\n        <div style={style}></div>\n      )}\n    </div>\n  );\n}\n\nfunction TokenName({ mint }: { mint: PublicKey }) {\n  const tokenMap = useTokenMap();\n  let tokenInfo = tokenMap.get(mint.toString());\n  return (\n    <Typography style={{ marginLeft: \"5px\" }}>{tokenInfo?.symbol}</Typography>\n  );\n}\n\nfunction SwapButton() {\n  const styles = useStyles();\n  const { fromMint, toMint, fromAmount, slippage, isClosingNewAccounts } =\n    useSwapContext();\n  const { swapClient } = useDexContext();\n  const fromMintInfo = useMint(fromMint);\n  const toMintInfo = useMint(toMint);\n  const openOrders = useOpenOrders();\n  const route = useRouteVerbose(fromMint, toMint);\n  const fromMarket = useMarket(\n    route && route.markets ? route.markets[0] : undefined\n  );\n  const toMarket = useMarket(\n    route && route.markets ? route.markets[1] : undefined\n  );\n  const canSwap = useCanSwap();\n  const referral = useReferral(fromMarket);\n  const fair = useSwapFair();\n\n  // Click handler.\n  const sendSwapTransaction = async () => {\n    if (!fromMintInfo || !toMintInfo) {\n      throw new Error(\"Unable to calculate mint decimals\");\n    }\n    if (!fair) {\n      throw new Error(\"Invalid fair\");\n    }\n    const amount = new BN(fromAmount).mul(\n      new BN(10).pow(new BN(fromMintInfo.decimals))\n    );\n    const minExchangeRate = {\n      rate: new BN(10 ** toMintInfo.decimals * (1 - BASE_TAKER_FEE_BPS))\n        .divn(fair)\n        .muln(100 - slippage)\n        .divn(100),\n      decimals: fromMintInfo.decimals,\n    };\n    const fromOpenOrders = fromMarket\n      ? openOrders.get(fromMarket?.address.toString())\n      : undefined;\n    const toOpenOrders = toMarket\n      ? openOrders.get(toMarket?.address.toString())\n      : undefined;\n    await swapClient.swap({\n      fromMint,\n      toMint,\n      amount,\n      minExchangeRate,\n      referral,\n      // Pass in the below parameters so that the client doesn't perform\n      // wasteful network requests when we already have the data.\n      fromMarket,\n      toMarket,\n      fromOpenOrders: fromOpenOrders ? fromOpenOrders[0].address : undefined,\n      toOpenOrders: toOpenOrders ? toOpenOrders[0].address : undefined,\n      // Auto close newly created open orders accounts.\n      close: isClosingNewAccounts,\n    });\n  };\n  return (\n    <Button\n      variant=\"contained\"\n      className={styles.swapButton}\n      onClick={sendSwapTransaction}\n      disabled={!canSwap}\n    >\n      Swap\n    </Button>\n  );\n}\n","import { PublicKey } from \"@solana/web3.js\";\nimport { TokenListContainer } from \"@solana/spl-token-registry\";\nimport { Provider } from \"@project-serum/anchor\";\nimport { Swap as SwapClient } from \"@project-serum/swap\";\nimport { SwapContextProvider } from \"./context/Swap\";\nimport { DexContextProvider } from \"./context/Dex\";\nimport { TokenListContextProvider } from \"./context/TokenList\";\nimport { TokenContextProvider } from \"./context/Token\";\nimport SwapCard from \"./components/Swap\";\n\n// The swap module exports a single `Swap` component that can be embedded into\n// applications.\nexport default function Swap({\n  style,\n  provider,\n  tokenList,\n  fromMint,\n  toMint,\n  fromAmount,\n  toAmount,\n  referral,\n}: {\n  provider: Provider;\n  tokenList: TokenListContainer;\n  fromMint?: PublicKey;\n  toMint?: PublicKey;\n  fromAmount?: number;\n  toAmount?: number;\n  referral?: PublicKey;\n  style?: any;\n}) {\n  const swapClient = new SwapClient(provider, tokenList);\n  return (\n    <TokenListContextProvider tokenList={tokenList}>\n      <TokenContextProvider provider={provider}>\n        <DexContextProvider swapClient={swapClient}>\n          <SwapContextProvider\n            fromMint={fromMint}\n            toMint={toMint}\n            fromAmount={fromAmount}\n            toAmount={toAmount}\n            referral={referral}\n          >\n            <SwapCard style={style} />\n          </SwapContextProvider>\n        </DexContextProvider>\n      </TokenContextProvider>\n    </TokenListContextProvider>\n  );\n}\n","import { useState, useEffect, useMemo } from \"react\";\nimport { SnackbarProvider, useSnackbar } from \"notistack\";\nimport { Button } from \"@material-ui/core\";\nimport { Provider } from \"@project-serum/anchor\";\n// @ts-ignore\nimport Wallet from \"@project-serum/sol-wallet-adapter\";\nimport {\n  Signer,\n  ConfirmOptions,\n  Connection,\n  Transaction,\n  TransactionSignature,\n} from \"@solana/web3.js\";\nimport {\n  TokenListContainer,\n  TokenListProvider,\n} from \"@solana/spl-token-registry\";\nimport Swap from \"./swap\";\nimport \"./App.css\";\n\n// App illustrating the use of the Swap component.\n//\n// One needs to just provide an Anchor `Provider` and a `TokenListContainer`\n// to the `Swap` component, and then everything else is taken care of.\nfunction App() {\n  return (\n    <SnackbarProvider maxSnack={5} autoHideDuration={8000}>\n      <AppInner />\n    </SnackbarProvider>\n  );\n}\n\nfunction AppInner() {\n  const { enqueueSnackbar } = useSnackbar();\n  const [isConnected, setIsConnected] = useState(false);\n  const [tokenList, setTokenList] = useState<TokenListContainer | null>(null);\n\n  const [provider, wallet] = useMemo(() => {\n    const opts: ConfirmOptions = {\n      preflightCommitment: \"recent\",\n      commitment: \"recent\",\n    };\n    const network = \"https://solana-api.projectserum.com\";\n    const wallet = new Wallet(\"https://www.sollet.io\", network);\n    const connection = new Connection(network, opts.preflightCommitment);\n    const provider = new NotifyingProvider(\n      connection,\n      wallet,\n      opts,\n      (tx, err) => {\n        if (err) {\n          enqueueSnackbar(`Error: ${err.toString()}`, {\n            variant: \"error\",\n          });\n        } else {\n          enqueueSnackbar(\"Transaction sent\", {\n            variant: \"success\",\n            action: (\n              <Button\n                color=\"inherit\"\n                component=\"a\"\n                target=\"_blank\"\n                rel=\"noopener\"\n                href={`https://explorer.solana.com/tx/${tx}`}\n              >\n                View on Solana Explorer\n              </Button>\n            ),\n          });\n        }\n      }\n    );\n    return [provider, wallet];\n  }, [enqueueSnackbar]);\n\n  useEffect(() => {\n    new TokenListProvider().resolve().then(setTokenList);\n  }, [setTokenList]);\n\n  // Connect to the wallet.\n  useEffect(() => {\n    wallet.on(\"connect\", () => {\n      enqueueSnackbar(\"Wallet connected\", { variant: \"success\" });\n      setIsConnected(true);\n    });\n    wallet.on(\"disconnect\", () => {\n      enqueueSnackbar(\"Wallet disconnected\", { variant: \"info\" });\n      setIsConnected(false);\n    });\n  }, [wallet, enqueueSnackbar]);\n\n  return (\n    <div\n      style={{\n        width: \"450px\",\n        marginLeft: \"auto\",\n        marginRight: \"auto\",\n        position: \"absolute\",\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: 0,\n        display: \"flex\",\n        justifyContent: \"center\",\n        flexDirection: \"column\",\n      }}\n    >\n      <Button\n        variant=\"outlined\"\n        onClick={() => (!isConnected ? wallet.connect() : wallet.disconnect())}\n        style={{ position: \"fixed\", right: 24, top: 24 }}\n      >\n        {!isConnected ? \"Connect\" : \"Disconnect\"}\n      </Button>\n      {tokenList && <Swap provider={provider} tokenList={tokenList} />}\n    </div>\n  );\n}\n\n// Custom provider to display notifications whenever a transaction is sent.\n//\n// Note that this is an Anchor wallet/network provider--not a React provider,\n// so all transactions will be flowing through here, which allows us to\n// hook in to display all transactions sent from the `Swap` component\n// as notifications in the parent app.\nclass NotifyingProvider extends Provider {\n  // Function to call whenever the provider sends a transaction;\n  private onTransaction: (\n    tx: TransactionSignature | undefined,\n    err?: Error\n  ) => void;\n\n  constructor(\n    connection: Connection,\n    wallet: Wallet,\n    opts: ConfirmOptions,\n    onTransaction: (tx: TransactionSignature | undefined, err?: Error) => void\n  ) {\n    super(connection, wallet, opts);\n    this.onTransaction = onTransaction;\n  }\n\n  async send(\n    tx: Transaction,\n    signers?: Array<Signer | undefined>,\n    opts?: ConfirmOptions\n  ): Promise<TransactionSignature> {\n    try {\n      const txSig = await super.send(tx, signers, opts);\n      this.onTransaction(txSig);\n      return txSig;\n    } catch (err) {\n      this.onTransaction(undefined, err);\n      return \"\";\n    }\n  }\n\n  async sendAll(\n    txs: Array<{ tx: Transaction; signers: Array<Signer | undefined> }>,\n    opts?: ConfirmOptions\n  ): Promise<Array<TransactionSignature>> {\n    try {\n      const txSigs = await super.sendAll(txs, opts);\n      txSigs.forEach((sig) => {\n        this.onTransaction(sig);\n      });\n      return txSigs;\n    } catch (err) {\n      this.onTransaction(undefined, err);\n      return [];\n    }\n  }\n}\n\nexport default App;\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}